{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yazenkova/Desktop/AgileIntPPMTool-master/desire-map-react-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yazenkova/Desktop/AgileIntPPMTool-master/desire-map-react-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";import{GET_ERRORS,SET_CURRENT_USER}from\"./types\";import setJWTToken from\"../securityUtils/setJWTToken\";import jwt_decode from\"jwt-decode\";export var createNewUser=function createNewUser(newUser,history){return(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post(\"/api/users/register\",newUser);case 3:history.push(\"/login\");dispatch({type:GET_ERRORS,payload:{}});_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);dispatch({type:GET_ERRORS,payload:_context.t0.response.data});case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function(_x){return _ref.apply(this,arguments);};}());};export var login=function login(LoginRequest){return(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var res,token,decoded;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post(\"/api/users/login\",LoginRequest);case 3:res=_context2.sent;// extract token from res.data\ntoken=res.data.token;// store the token in the localStorage\nlocalStorage.setItem(\"jwtToken\",token);// set our token in header ***\nsetJWTToken(token);// decode token on React\ndecoded=jwt_decode(token);// dispatch to our securityReducer\ndispatch({type:SET_CURRENT_USER,payload:decoded});_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);dispatch({type:GET_ERRORS,payload:_context2.t0.response.data});case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));return function(_x2){return _ref2.apply(this,arguments);};}());};export var logout=function logout(){return function(dispatch){localStorage.removeItem(\"jwtToken\");setJWTToken(false);dispatch({type:SET_CURRENT_USER,payload:{}});};};","map":{"version":3,"sources":["/Users/yazenkova/Desktop/AgileIntPPMTool-master/desire-map-react-client/src/actions/securityActions.js"],"names":["axios","GET_ERRORS","SET_CURRENT_USER","setJWTToken","jwt_decode","createNewUser","newUser","history","dispatch","post","push","type","payload","response","data","login","LoginRequest","res","token","localStorage","setItem","decoded","logout","removeItem"],"mappings":"yXAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,CAAqBC,gBAArB,KAA6C,SAA7C,CACA,MAAOC,CAAAA,WAAP,KAAwB,8BAAxB,CACA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,CAEA,MAAO,IAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,OAAD,CAAUC,OAAV,kGAAsB,iBAAMC,QAAN,wJAEzCR,CAAAA,KAAK,CAACS,IAAN,CAAW,qBAAX,CAAkCH,OAAlC,CAFyC,QAG/CC,OAAO,CAACG,IAAR,CAAa,QAAb,EACAF,QAAQ,CAAC,CACPG,IAAI,CAAEV,UADC,CAEPW,OAAO,CAAE,EAFF,CAAD,CAAR,CAJ+C,+EAS/CJ,QAAQ,CAAC,CACPG,IAAI,CAAEV,UADC,CAEPW,OAAO,CAAE,YAAIC,QAAJ,CAAaC,IAFf,CAAD,CAAR,CAT+C,oEAAtB,iEAAtB,CAgBP,MAAO,IAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAAAC,YAAY,mGAAI,kBAAMR,QAAN,oLAGfR,CAAAA,KAAK,CAACS,IAAN,CAAW,kBAAX,CAA+BO,YAA/B,CAHe,QAG3BC,GAH2B,gBAIjC;AACQC,KALyB,CAKfD,GAAG,CAACH,IALW,CAKzBI,KALyB,CAMjC;AACAC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAiCF,KAAjC,EACA;AACAf,WAAW,CAACe,KAAD,CAAX,CACA;AACMG,OAX2B,CAWjBjB,UAAU,CAACc,KAAD,CAXO,CAYjC;AACAV,QAAQ,CAAC,CACPG,IAAI,CAAET,gBADC,CAEPU,OAAO,CAAES,OAFF,CAAD,CAAR,CAbiC,qFAkBjCb,QAAQ,CAAC,CACPG,IAAI,CAAEV,UADC,CAEPW,OAAO,CAAE,aAAIC,QAAJ,CAAaC,IAFf,CAAD,CAAR,CAlBiC,uEAAJ,mEAA1B,CAyBP,MAAO,IAAMQ,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,SAAM,UAAAd,QAAQ,CAAI,CACtCW,YAAY,CAACI,UAAb,CAAwB,UAAxB,EACApB,WAAW,CAAC,KAAD,CAAX,CACAK,QAAQ,CAAC,CACPG,IAAI,CAAET,gBADC,CAEPU,OAAO,CAAE,EAFF,CAAD,CAAR,CAID,CAPqB,EAAf","sourcesContent":["import axios from \"axios\";\nimport { GET_ERRORS, SET_CURRENT_USER } from \"./types\";\nimport setJWTToken from \"../securityUtils/setJWTToken\";\nimport jwt_decode from \"jwt-decode\";\n\nexport const createNewUser = (newUser, history) => async dispatch => {\n  try {\n    await axios.post(\"/api/users/register\", newUser);\n    history.push(\"/login\");\n    dispatch({\n      type: GET_ERRORS,\n      payload: {}\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\n\nexport const login = LoginRequest => async dispatch => {\n  try {\n    // post => Login Request\n    const res = await axios.post(\"/api/users/login\", LoginRequest);\n    // extract token from res.data\n    const { token } = res.data;\n    // store the token in the localStorage\n    localStorage.setItem(\"jwtToken\", token);\n    // set our token in header ***\n    setJWTToken(token);\n    // decode token on React\n    const decoded = jwt_decode(token);\n    // dispatch to our securityReducer\n    dispatch({\n      type: SET_CURRENT_USER,\n      payload: decoded\n    });\n  } catch (err) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: err.response.data\n    });\n  }\n};\n\nexport const logout = () => dispatch => {\n  localStorage.removeItem(\"jwtToken\");\n  setJWTToken(false);\n  dispatch({\n    type: SET_CURRENT_USER,\n    payload: {}\n  });\n};\n"]},"metadata":{},"sourceType":"module"}